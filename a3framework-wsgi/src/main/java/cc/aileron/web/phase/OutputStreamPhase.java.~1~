/**
 * 
 */
package cc.aileron.web.phase;

import java.nio.channels.WritableByteChannel;

import cc.aileron.web.WebProcess;
import cc.aileron.wsgi.Wsgi;
import cc.aileron.wsgi.Wsgi.Response.StreamWriteProcesser;

/**
 * @author aileron
 */
public interface OutputStreamPhase
{
    /**
     * @author aileron
     */
    class Executor implements WebProcess<OutputStreamPhase>
    {
        @Override
        public cc.aileron.web.WebProcess.Case process(
                final OutputStreamPhase resource) throws Exception
        {
            Wsgi.Response(new StreamWriteProcesser()
            {
                @Override
                public void write(final WritableByteChannel channel)
                        throws Exception
                {
                    resource.output(channel);
                }
            });
            return Case.TERMINATE;
        }
    }

    /**
     * HTTP Header
     */
    class Header
    {
        /**
         * @param name
         * @param value
         */
        public Header(final String name, final String value)
        {
            this.name = name;
            this.value = value;
        }

        /**
         * key
         */
        public final String name;

        /**
         * value
         */
        public final String value;
    }

    /**
     * @return {@link Header}
     */
    Header[] headers();

    /**
     * @param channel
     * @throws Exception
     */
    void output(WritableByteChannel channel) throws Exception;
}
